<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <link href="https://fonts.cdnfonts.com/css/myriad-pro" rel="stylesheet">
  <link rel="stylesheet" href="css/dashboard-style.css">

  <style>
  

    .content {
      margin-left: 0px;
      padding: 20px;
    }

    h1 {
      color: #222;
      margin-bottom: 20px;
    }

    /* 🌟 Two-column layout for events */
    #eventList {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
    }

    .event-card {
      background-color: white;
      border-left: 6px solid #0078d7;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: transform 0.2s, box-shadow 0.2s;
      display: flex;
      flex-direction: column;
    }

    .event-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(0,0,0,0.15);
    }

    .event-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .event-info {
      padding: 15px;
      flex-grow: 1;
    }

    .event-info h3 {
      margin: 0 0 8px 0;
      color: #333;
    }

    .event-info p {
      margin: 4px 0;
      color: #555;
      font-size: 14px;
    }

    .event-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      padding: 10px 15px 15px 15px;
      border-top: 1px solid #eee;
    }

    .event-buttons button {
      padding: 6px 12px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      color: white;
      font-size: 14px;
    }

    .edit-btn {
      background-color: #27ae60;
    }

    .edit-btn:hover {
      background-color: #219150;
    }

    .delete-btn {
      background-color: #e74c3c;
    }

    .delete-btn:hover {
      background-color: #c0392b;
    }

    .no-events {
      text-align: center;
      color: #777;
      margin-top: 40px;
      grid-column: span 2;
    }
    .input-field {
  width: 100%;
  padding: 8px;
  margin: 4px 0 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}

  </style>
</head>

<body>
    <!-- 🌐 Navigation Bar -->
    <nav>
        <div class="tabs">
            <a href="index.html">Home</a>
            <a href="about.html">About Us</a>
            <a href="developers.html">Developers</a>
        </div>
    </nav>

    <!-- 🧭 Sidebar -->
    <div class="sidebar">
        <div class="profile">
            <img src="\Assets\user_img.png" alt="Profile">
            <h2 id="usernameDisplay">User</h2>
        </div>

        <a href="admin_dashboard.html" class="sd_button">Dashboard</a>
        <a href="manage_students.html" class="sd_button">Manage Students</a>

        <div class="filter_title">
            <h3>Course Filter</h3>
        </div><br>
        <a href="create_event.html" class="sd_button">Create Events</a>
        <!--<a href="manage_events.html" class="sd_button">Manage Events</a>-->
        <a href="#" class="sd_button">Attendancce Checker</a>

        <div class="signout">
            <button onclick="signOut()">Sign Out</button>
        </div>
    </div>

    <!-- 🧾 Main Content -->
    <div class="main-content">
        <!-- 🔍 Search Bar -->


  <!-- 🧾 Main Content -->
  <div class="content">
    <h1>Event Dashboard</h1>
    <div id="eventList"></div>
  </div>

  <!-- 💻 Script -->
<script>
  function getEvents() {
    try {
      return JSON.parse(localStorage.getItem('events')) || [];
    } catch (e) {
      console.error('Could not parse events from localStorage', e);
      return [];
    }
  }

  function setEvents(arr) {
    localStorage.setItem('events', JSON.stringify(arr));
  }

  function renderEvents() {
    const eventList = document.getElementById('eventList');
    const events = getEvents();

    eventList.innerHTML = '';

    if (events.length === 0) {
      eventList.innerHTML = '<p class="no-events">No events have been created yet.</p>';
      return;
    }

    events.forEach((evt) => {
      const card = document.createElement('div');
      card.classList.add('event-card');
      card.id = `event-${evt.id}`;

      const imageHTML = evt.image 
        ? `<img src="${evt.image}" alt="${evt.name}" class="event-image">`
        : `<img src="Assets/default_event.png" alt="Default Event" class="event-image">`;

      card.innerHTML = `
        ${imageHTML}
        <div class="event-info">
          <h3>${evt.name}</h3>
          <p><strong>Date:</strong> ${evt.date} | <strong>Time:</strong> ${evt.time}</p>
          <p><strong>Course:</strong> ${evt.course}</p>
          <p><strong>Type:</strong> ${evt.type}</p>
          <p><strong>Place:</strong> ${evt.place}</p>
          <p><strong>Capacity:</strong> ${evt.capacity}</p>
          <p><strong>Description:</strong> ${evt.description}</p>
        </div>
        <div class="event-buttons">
          <button class="edit-btn" onclick="openEditForm('${evt.id}')">Edit</button>
          <button class="delete-btn" onclick="deleteEvent('${evt.id}')">Delete</button>
        </div>
      `;
      eventList.appendChild(card);
    });
  }

  // 📝 Inline edit form
  function openEditForm(id) {
    const events = getEvents();
    const evt = events.find(e => e.id === id);
    if (!evt) return alert("Event not found!");

    const card = document.getElementById(`event-${id}`);
    card.innerHTML = `
      <div class="event-info">
        <h3>Edit Event</h3>
        <label>Name:</label>
        <input type="text" id="editName-${id}" value="${evt.name}" class="input-field">
        <label>Date:</label>
        <input type="date" id="editDate-${id}" value="${evt.date}" class="input-field">
        <label>Time:</label>
        <input type="time" id="editTime-${id}" value="${evt.time}" class="input-field">
        <label>Course:</label>
        <input type="text" id="editCourse-${id}" value="${evt.course}" class="input-field">
        <label>Type:</label>
        <input type="text" id="editType-${id}" value="${evt.type}" class="input-field">
        <label>Place:</label>
        <input type="text" id="editPlace-${id}" value="${evt.place}" class="input-field">
        <label>Capacity:</label>
        <input type="number" id="editCapacity-${id}" value="${evt.capacity}" class="input-field">
        <label>Description:</label>
        <textarea id="editDescription-${id}" class="input-field">${evt.description}</textarea>
        <label>Update Image:</label>
        <input type="file" id="editImage-${id}" accept="image/*" class="input-field">
      </div>

      <div class="event-buttons">
        <button class="edit-btn" onclick="saveEdit('${id}')">Update</button>
        <button class="delete-btn" onclick="renderEvents()">Cancel</button>
      </div>
    `;
  }

  // 💾 Save edited event
  function saveEdit(id) {
    const events = getEvents();
    const index = events.findIndex(e => e.id === id);
    if (index === -1) return alert("Event not found!");

    const fileInput = document.getElementById(`editImage-${id}`);
    const reader = new FileReader();

    const saveData = (imageData) => {
      events[index] = {
        ...events[index],
        name: document.getElementById(`editName-${id}`).value,
        date: document.getElementById(`editDate-${id}`).value,
        time: document.getElementById(`editTime-${id}`).value,
        course: document.getElementById(`editCourse-${id}`).value,
        type: document.getElementById(`editType-${id}`).value,
        place: document.getElementById(`editPlace-${id}`).value,
        capacity: document.getElementById(`editCapacity-${id}`).value,
        description: document.getElementById(`editDescription-${id}`).value,
        image: imageData || events[index].image
      };

      setEvents(events);
      renderEvents();
    };

    if (fileInput.files && fileInput.files[0]) {
      reader.onload = (e) => saveData(e.target.result);
      reader.readAsDataURL(fileInput.files[0]);
    } else {
      saveData();
    }
  }

  function deleteEvent(id) {
    if (!confirm("Are you sure you want to delete this event?")) return;
    const events = getEvents().filter(e => e.id !== id);
    setEvents(events);
    renderEvents();
  }

  function signOut() {
    localStorage.removeItem("loggedInUser");
    window.location.href = "index.html";
  }

  renderEvents();
</script>

</body>
</html>
